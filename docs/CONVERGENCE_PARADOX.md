# RFC = 1.0 ìˆ˜ë ´ íŒ¨ëŸ¬ë…ìŠ¤: ë†’ì€ ì‹ ë¢°ë„, ë¶€ì •í™•í•œ ìœ„ì¹˜

## ğŸ¯ ë¬¸ì œ ìš”ì•½

**RFCëŠ” 1.0ìœ¼ë¡œ ì™„ë²½íˆ ìˆ˜ë ´í–ˆì§€ë§Œ, ì˜ˆì¸¡ëœ ì†ŒìŠ¤ ìœ„ì¹˜ê°€ ì‹¤ì œì™€ í¬ê²Œ ë‹¤ë¦„**

### ì‹¤ì œ vs ì˜ˆì¸¡ ë¹„êµ

| êµ¬ë¶„ | Source 1 | Source 2 | Source 3 |
|------|----------|----------|----------|
| **ì‹¤ì œ ìœ„ì¹˜** | (183, 43) | (44, 66) | (186, 172) |
| **ì˜ˆì¸¡ ìœ„ì¹˜** | (87, 101) | (98, 42) | (69, 14) |
| **ê±°ë¦¬ ì˜¤ì°¨** | **137 px** | **69 px** | **165 px** |
| **ì‹¤ì œ ê°•ë„** | 60.72 | 98.29 | 38.97 |
| **ì˜ˆì¸¡ ê°•ë„** | 32.27 | 14.33 | 10.96 |

**ì¶”ê°€ë¡œ ì˜ëª»ëœ 4ë²ˆì§¸ ì†ŒìŠ¤**: (93, 238), A=10.98

---

## ğŸ” ì›ì¸ ë¶„ì„

### 1. ê·¹ë„ë¡œ ì œí•œëœ íƒìƒ‰ ì˜ì—­

```
ë¡œë´‡ ê²½ë¡œ:
  Step 0: (128.0, 128.0) - ì‹œì‘
  Step 1: (124.8, 106.3) - ì•½ê°„ ì´ë™
  Step 2: (94.5, 191.9)  - ìµœì¢… ìœ„ì¹˜

íƒìƒ‰ ì˜ì—­:
  X: 94.5 ~ 128.0 (ë²”ìœ„: 33.5 pixels)
  Y: 106.3 ~ 191.9 (ë²”ìœ„: 85.6 pixels)

ì»¤ë²„ìœ¨: 4.4% (ì „ì²´ 256Ã—256 ë§µ ì¤‘)
```

**ëª¨ë“  ì‹¤ì œ ì†ŒìŠ¤ê°€ íƒìƒ‰ ì˜ì—­ ë°–ì— ìœ„ì¹˜!**

| ì†ŒìŠ¤ | X ë²”ìœ„ ë‚´? | Y ë²”ìœ„ ë‚´? | ê°€ì¥ ê°€ê¹Œìš´ ê´€ì¸¡ |
|------|-----------|-----------|----------------|
| Source 1 (183, 43) | âŒ (183 >> 128) | âŒ (43 << 106) | 86 px |
| Source 2 (44, 66) | âŒ (44 << 94) | âŒ (66 << 106) | 90 px |
| Source 3 (186, 172) | âŒ (186 >> 128) | âœ“ (172 in range) | 73 px |

---

### 2. ì—­ë¬¸ì œ(Inverse Problem)ì˜ ë¹„ìœ ì¼ì„±

**í•µì‹¬**: ì œí•œëœ ê´€ì¸¡ìœ¼ë¡œëŠ” ë¬´ìˆ˜íˆ ë§ì€ ì†ŒìŠ¤ ë°°ì¹˜ê°€ ê°™ì€ ê´€ì¸¡ê°’ì„ ë§Œë“¤ ìˆ˜ ìˆìŒ

#### ì˜ˆì‹œ: ê´€ì¸¡ ìœ„ì¹˜ (128, 128)ì—ì„œ ê°•ë„ 14.32

**ì‹¤ì œ êµ¬ì„± (ë¨¼ ê±°ë¦¬, ê°•í•œ ì†ŒìŠ¤)**:
```
Source 1 @ 101px: 60.72 / (0.25 + 3.96Â²) = 3.82
Source 2 @ 104px: 98.29 / (0.25 + 4.07Â²) = 5.82
Source 3 @ 73px:  38.97 / (0.25 + 2.85Â²) = 4.67
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total: 14.31 âœ“
```

**ì˜ˆì¸¡ êµ¬ì„± (ê°€ê¹Œìš´ ê±°ë¦¬, ì•½í•œ ì†ŒìŠ¤)**:
```
Est 1 @ 28px: 32.27 / (0.25 + 1.09Â²) = 21.62
Est 2 @ 27px: 14.33 / (0.25 + 1.05Â²) = 12.31
Est 3 @ 114px: 10.96 / (0.25 + 4.45Â²) = 0.54
Est 4 @ 113px: 10.98 / (0.25 + 4.41Â²) = 0.56
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Total: 10.12 (ì˜¤ì°¨ 29%, í•˜ì§€ë§Œ ì—¬ì „íˆ RFC=1.0!)
```

**ë™ë“±ì„±**: ë‘ êµ¬ì„± ëª¨ë‘ ê´€ì¸¡ëœ 3ê°œ ìœ„ì¹˜ì—ì„œ ìœ ì‚¬í•œ ê°•ë„ë¥¼ ìƒì„±
- ê´€ì¸¡ 1: 3-29% ì˜¤ì°¨
- ê´€ì¸¡ 2: 3% ì˜¤ì°¨
- ê´€ì¸¡ 3: 19% ì˜¤ì°¨

â†’ **Poisson í™•ë¥  ë¹„ìœ¨ì´ ëª¨ë‘ ë†’ìŒ â†’ RFC = 1.0**

---

### 3. RFCì˜ í•œê³„

#### RFCê°€ ì¸¡ì •í•˜ëŠ” ê²ƒ
âœ… ì˜ˆì¸¡ ì†ŒìŠ¤ë“¤ì´ **ê´€ì¸¡ëœ ìœ„ì¹˜ì—ì„œ** ê°•ë„ë¥¼ ì˜ ì¬í˜„í•˜ëŠ”ê°€?

#### RFCê°€ ë³´ì¥í•˜ì§€ ì•ŠëŠ” ê²ƒ
âŒ ì˜ˆì¸¡ ì†ŒìŠ¤ë“¤ì´ **ì‹¤ì œ ì†ŒìŠ¤ ìœ„ì¹˜**ì™€ ì¼ì¹˜í•˜ëŠ”ê°€?
âŒ **ê´€ì¸¡ë˜ì§€ ì•Šì€ ì˜ì—­**ì—ì„œë„ ê°•ë„ê°€ ì •í™•í•œê°€?
âŒ ì†ŒìŠ¤ì˜ **ê°œìˆ˜**ê°€ ì •í™•í•œê°€? (3ê°œì¸ë° 4ê°œë¡œ ì¶”ì •)

---

## ğŸ“Š ìˆ˜í•™ì  ì„¤ëª…

### RFC ì •ì˜ (Equation 7)

```
RFC = (1/N_o) Ã— Î£ [ P(k_obs | Î»_pred) / P(âŒŠÎ»_predâŒ‹ | Î»_pred) ]
```

**ê´€ì¸¡ì´ 3ê°œë¿ì¼ ë•Œ**:
- N_o = 3 (ë§¤ìš° ì ìŒ!)
- 3ê°œ ìœ„ì¹˜ì—ì„œë§Œ ì˜ˆì¸¡ ì •í™•ë„ í‰ê°€
- ë‚˜ë¨¸ì§€ 256Â² - 3 = 65,533ê°œ ìœ„ì¹˜ëŠ” ê²€ì¦ ì•ˆ ë¨

**êµ­ì†Œ ìµœì í™”**:
```python
# ADE-PSPF ëª©ì  í•¨ìˆ˜
maximize: RFC(observations, centroids)

# ì œì•½ ì¡°ê±´
observations = [(128,128), (125,106), (95,192)]  # ê³ ì •ëœ 3ê°œ

# ê²°ê³¼
â†’ ì´ 3ê°œ ìœ„ì¹˜ë§Œ ì˜ ë§ì¶”ë©´ RFC = 1.0
â†’ ì‹¤ì œ ì†ŒìŠ¤ ìœ„ì¹˜ëŠ” ê³ ë ¤ ì•ˆ ë¨
```

---

## ğŸ”¬ ì‹¤í—˜ì  ê²€ì¦

### ê´€ì¸¡ ìœ„ì¹˜ë³„ ì˜ˆì¸¡ vs ì‹¤ì œ

| ìœ„ì¹˜ | ì‹¤ì œ ê°•ë„ | ì˜ˆì¸¡ ê°•ë„ | ì˜¤ì°¨ | Poisson ë¹„ìœ¨ |
|------|-----------|-----------|------|-------------|
| (128, 128) | 14.32 | 10.12 | 29% | ~0.90 |
| (125, 106) | 16.17 | 15.68 | 3% | ~1.00 |
| (95, 192) | 7.69 | 6.21 | 19% | ~0.95 |

**í‰ê·  Poisson ë¹„ìœ¨**: (0.90 + 1.00 + 0.95) / 3 â‰ˆ **0.95**

â†’ RFCëŠ” ì´ë¥¼ 1.0ìœ¼ë¡œ clipping â†’ **"ìˆ˜ë ´"ìœ¼ë¡œ íŒë‹¨**

---

## ğŸ’¡ ì™œ ì´ëŸ° ì¼ì´ ë°œìƒí–ˆëŠ”ê°€?

### 1. Gain = 0 ë¬¸ì œ

```python
# RRT Gain ê³„ì‚° (Equation 11-22)
gain = radiation_gain + unexplored_gain + distance_penalty

# RFC = 0ì¼ ë•Œ (Iteration 1-4)
radiation_gain â‰ˆ 0  # ì†ŒìŠ¤ ì¶”ì •ì´ ì—‰ë§
unexplored_gain â‰ˆ 0  # ì–´ë””ë“  ë¯¸íƒìƒ‰
distance_penalty â‰ˆ 0

â†’ ëª¨ë“  ê²½ë¡œì˜ gain = 0
â†’ ëœë¤í•˜ê²Œ ê²½ë¡œ ì„ íƒ
â†’ ì¢ì€ ì˜ì—­ë§Œ íƒìƒ‰
```

### 2. ì¡°ê¸° ìˆ˜ë ´

```
Iteration 1-4: RFC = 0.0000 (ë„“ê²Œ íƒìƒ‰, gain=0ìœ¼ë¡œ ëœë¤)
Iteration 5: RFC = 1.0000 (ê°‘ìê¸° ìˆ˜ë ´!)

â†’ ë„“ì€ íƒìƒ‰ ê¸°íšŒ ì—†ì´ ì¢…ë£Œ
```

### 3. íƒìƒ‰ ì „ëµ ë¶€ì¬

- ì´ˆê¸° Grid íƒìƒ‰ ì—†ìŒ
- ì •ë³´ ì´ë“ ê¸°ë°˜ íƒìƒ‰ ì—†ìŒ
- ë¶ˆí™•ì‹¤ì„± ê°ì†Œ ëª©í‘œ ì—†ìŒ

---

## ğŸ› ï¸ í•´ê²° ë°©ë²•

### ë°©ë²• 1: ì´ˆê¸° Grid íƒìƒ‰ ì¶”ê°€ â­â­â­â­â­

```python
def initial_grid_exploration(self):
    """ì „ì²´ ë§µì„ Gridë¡œ ë‚˜ëˆ„ì–´ ê· ë“±í•˜ê²Œ íƒìƒ‰"""

    # 4Ã—4 Grid (16ê°œ ìœ„ì¹˜)
    grid_points = [
        (64, 64), (64, 128), (64, 192),   # ì™¼ìª½
        (128, 64), (128, 128), (128, 192), # ì¤‘ì•™
        (192, 64), (192, 128), (192, 192), # ì˜¤ë¥¸ìª½
    ]

    for pos in grid_points:
        self.robot.move_to(*pos, theta=0)
        self._make_observation(*pos)

        # ADE-PSPF ì—…ë°ì´íŠ¸
        result = self.estimator.update(self.robot.observations)

        if result['rfc'] >= 0.5:  # ì¶©ë¶„í•œ ì •ë³´ ìˆ˜ì§‘
            break
```

**íš¨ê³¼**:
- ì „ì²´ ë§µì˜ 36% ì»¤ë²„ (vs í˜„ì¬ 4.4%)
- ëª¨ë“  ì‚¬ë¶„ë©´ íƒìƒ‰
- ì‹¤ì œ ì†ŒìŠ¤ ê·¼ì²˜ ë°©ë¬¸ í™•ë¥  ì¦ê°€

---

### ë°©ë²• 2: RFC ìˆ˜ë ´ ì¡°ê±´ ê°•í™” â­â­â­â­

**í˜„ì¬ (ë¬¸ì œ)**:
```python
if rfc >= 0.85:
    converged = True
    break
```

**ê°œì„ ì•ˆ**:
```python
# ì¡°ê±´ 1: RFC ë†’ìŒ
# ì¡°ê±´ 2: ê³µê°„ ì»¤ë²„ë¦¬ì§€ ì¶©ë¶„
# ì¡°ê±´ 3: ì—°ì† ìˆ˜ë ´ í™•ì¸

def check_convergence(self):
    rfc_ok = self.current_rfc >= 0.85

    # ê³µê°„ ì»¤ë²„ë¦¬ì§€ ê³„ì‚°
    visited_area = self._compute_visited_area()
    coverage_ratio = visited_area / (256 * 256)
    coverage_ok = coverage_ratio >= 0.15  # ìµœì†Œ 15%

    # ì—°ì† 3íšŒ ì´ìƒ RFC >= 0.85
    recent_rfcs = self.rfc_history[-3:]
    stable_ok = all(r >= 0.85 for r in recent_rfcs)

    return rfc_ok and coverage_ok and stable_ok
```

**íš¨ê³¼**:
- ì¡°ê¸° ìˆ˜ë ´ ë°©ì§€
- ë” ë„“ì€ íƒìƒ‰ ê°•ì œ
- ì•ˆì •ì ì¸ ìˆ˜ë ´ ë³´ì¥

---

### ë°©ë²• 3: Exploration Bonus ì¶”ê°€ â­â­â­

```python
def compute_exploration_gain(self, position):
    """ë¯¸íƒìƒ‰ ì˜ì—­ì— ë³´ë„ˆìŠ¤ ë¶€ì—¬"""

    # ê°€ì¥ ê°€ê¹Œìš´ ê´€ì¸¡ê¹Œì§€ì˜ ê±°ë¦¬
    min_dist = min(
        np.linalg.norm(position - obs_pos)
        for obs_pos, _ in self.observations
    )

    # ê±°ë¦¬ê°€ ë©€ìˆ˜ë¡ ë†’ì€ ë³´ë„ˆìŠ¤
    exploration_bonus = min_dist / 50.0  # ì •ê·œí™”

    return exploration_bonus

# RRT Gainì— ì¶”ê°€
total_gain = radiation_gain + exploration_bonus + unexplored_gain
```

**íš¨ê³¼**:
- ë¨¼ ê³³ íƒìƒ‰ ì¥ë ¤
- ê´€ì¸¡ ë°€ë„ ê· ë“±í™”

---

### ë°©ë²• 4: ì†ŒìŠ¤ ê°œìˆ˜ ì‚¬ì „ ì •ë³´ í™œìš© â­â­

```python
config = ExplorationConfig(
    expected_n_sources=3,  # Ground truth ì •ë³´
    max_n_sources=4,
)

# ADE-PSPFì— ì „ë‹¬
adepspf_config = ADEPSPFConfig(
    n_swarms=3,  # expected_n_sourcesì™€ ì¼ì¹˜
)
```

**íš¨ê³¼**:
- ê³¼ì í•© ë°©ì§€ (4ê°œ ëŒ€ì‹  3ê°œ ì¶”ì •)
- ë” ì •í™•í•œ ìœ„ì¹˜ ì¶”ì •

---

### ë°©ë²• 5: ë‹¤ë‹¨ê³„ ìˆ˜ë ´ ê²€ì¦ â­â­â­â­

```python
def verify_convergence(self):
    """ìˆ˜ë ´ í›„ ì¶”ê°€ ê²€ì¦"""

    if self.current_rfc >= 0.85:
        # Step 1: ì „ì²´ ë§µì—ì„œ ë¬´ì‘ìœ„ 10ê°œ ìœ„ì¹˜ ìƒ˜í”Œ
        test_positions = random.sample(
            all_positions, k=10
        )

        # Step 2: ì˜ˆì¸¡ vs ì‹¤ì œ ë¹„êµ
        errors = []
        for pos in test_positions:
            true_intensity = self.observer.observe(pos)
            pred_intensity = self.predict_at(pos)
            error = abs(pred - true) / true
            errors.append(error)

        # Step 3: í‰ê·  ì˜¤ì°¨ < 30% í™•ì¸
        avg_error = np.mean(errors)

        return avg_error < 0.3
```

**íš¨ê³¼**:
- ê´€ì¸¡ ì˜ì—­ ë°–ì—ì„œë„ ê²€ì¦
- ì‹¤ì œ ì •í™•ë„ í™•ì¸

---

## ğŸ“ˆ ì˜ˆìƒ ê°œì„  íš¨ê³¼

### í˜„ì¬
```
íƒìƒ‰ ì˜ì—­: 4.4%
ê´€ì¸¡ ìˆ˜: 18ê°œ (ì¢ì€ ì˜ì—­ì— ì§‘ì¤‘)
RFC: 1.0 âœ“
ìœ„ì¹˜ ì˜¤ì°¨: 69-165 pixels âœ—
```

### ê°œì„  í›„ (ë°©ë²• 1+2+3 ì ìš©)
```
íƒìƒ‰ ì˜ì—­: 36%+ (Grid íƒìƒ‰)
ê´€ì¸¡ ìˆ˜: 50ê°œ+ (ê· ë“± ë¶„í¬)
RFC: 0.90+ (ì•ˆì •ì )
ìœ„ì¹˜ ì˜¤ì°¨: < 20 pixels âœ“
ìˆ˜ë ´ ì‹œê°„: 20-30 iterations
```

---

## ğŸ“ êµí›ˆ

### RFCì˜ ì˜ë¯¸ ì¬ì •ì˜

**RFCëŠ”**:
- âœ… ëª¨ë¸ì˜ **ê´€ì¸¡ ì¬í˜„ ëŠ¥ë ¥** ì§€í‘œ
- âœ… **ê´€ì¸¡ëœ ì˜ì—­**ì—ì„œì˜ ì‹ ë¢°ë„
- âœ… ìƒëŒ€ì  ìˆ˜ë ´ ì§€í‘œ

**RFCëŠ” ì•„ë‹˜**:
- âŒ **ì ˆëŒ€ì  ì •í™•ë„** ì§€í‘œ
- âŒ **ì „ì—­ ìµœì í•´** ë³´ì¥
- âŒ **ì†ŒìŠ¤ ìœ„ì¹˜ ì •í™•ë„** ì¸¡ì •

### íƒìƒ‰ì˜ ì¤‘ìš”ì„±

```
ì¢‹ì€ ì¶”ì • = ì¢‹ì€ ì•Œê³ ë¦¬ì¦˜ + ì¶©ë¶„í•œ íƒìƒ‰
```

ì•„ë¬´ë¦¬ ì¢‹ì€ ì¶”ì • ì•Œê³ ë¦¬ì¦˜(ADE-PSPF)ì´ë¼ë„:
- ë°ì´í„°ê°€ í¸í–¥ë˜ë©´ â†’ í¸í–¥ëœ ê²°ê³¼
- ë°ì´í„°ê°€ ë¶€ì¡±í•˜ë©´ â†’ êµ­ì†Œ ìµœì í•´
- ë°ì´í„° ì»¤ë²„ë¦¬ì§€ê°€ ë‚®ìœ¼ë©´ â†’ ë¹„ìœ ì¼ í•´

---

## ğŸ“ ê¶Œì¥ ì‚¬í•­

### ì¦‰ì‹œ ì ìš© (ìš°ì„ ìˆœìœ„ ë†’ìŒ)
1. âœ… **ì´ˆê¸° Grid íƒìƒ‰** êµ¬í˜„
2. âœ… **ê³µê°„ ì»¤ë²„ë¦¬ì§€** ì¢…ë£Œ ì¡°ê±´ ì¶”ê°€
3. âœ… **Exploration Bonus** ì¶”ê°€

### ì¤‘ê¸° ê°œì„ 
4. ì •ë³´ ì´ë“(Information Gain) ê¸°ë°˜ íƒìƒ‰
5. Uncertainty-aware ê²½ë¡œ ê³„íš
6. ë‹¤ì¤‘ ìŠ¤ì¼€ì¼ íƒìƒ‰ (coarse â†’ fine)

### ì¥ê¸° ê°œì„ 
7. Active Learning ì „ëµ
8. Bayesian Optimization ì ìš©
9. POMDP ê¸°ë°˜ planning

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

- [FIX_RESULTS.md](FIX_RESULTS.md) - RFC = 0 ë¬¸ì œ í•´ê²°
- [RFC_ZERO_COMPLETE_ANALYSIS.md](RFC_ZERO_COMPLETE_ANALYSIS.md) - RFC ê³„ì‚° ë¶„ì„
- [TRAJECTORY_ISSUE.md](TRAJECTORY_ISSUE.md) - ë¡œë´‡ ì´ë™ ë¬¸ì œ

---

## ğŸ“Š ì‹œê°í™”

ìƒì„±ëœ ì´ë¯¸ì§€ì—ì„œ í™•ì¸ ê°€ëŠ¥:
- [data/figures/integrated_explorer_v2_result.png](data/figures/integrated_explorer_v2_result.png)
  - **ì™¼ìª½ ìƒë‹¨**: Ground Truth (ì‹¤ì œ ì†ŒìŠ¤) vs Trajectory (ë§¤ìš° ì§§ìŒ)
  - **ì˜¤ë¥¸ìª½ ìƒë‹¨**: ì¶”ì • ì†ŒìŠ¤ (ì‹¤ì œ ìœ„ì¹˜ì™€ í° ì°¨ì´)
  - **ì™¼ìª½ í•˜ë‹¨**: RFC = 1.0 ìˆ˜ë ´ ê·¸ë˜í”„
  - **ì˜¤ë¥¸ìª½ í•˜ë‹¨**: í†µê³„ (4.4% ì»¤ë²„ìœ¨!)

---

## âœ… ê²°ë¡ 

**RFC = 1.0 â‰  ì™„ë²½í•œ ì¶”ì •**

- RFCëŠ” êµ­ì†Œì  ì‹ ë¢°ë„ì¼ ë¿, ì „ì—­ ì •í™•ë„ë¥¼ ë³´ì¥í•˜ì§€ ì•ŠìŒ
- ì¶©ë¶„í•œ ê³µê°„ íƒìƒ‰ ì—†ì´ëŠ” ì •í™•í•œ ì†ŒìŠ¤ ìœ„ì¹˜ ì¶”ì • ë¶ˆê°€
- **í•´ê²°ì±…: ì´ˆê¸° Grid íƒìƒ‰ + ì»¤ë²„ë¦¬ì§€ ê¸°ë°˜ ì¢…ë£Œ ì¡°ê±´**
